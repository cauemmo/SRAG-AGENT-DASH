## 179. DIAGRAMA DE ARQUITETURA GERAL

```mermaid
graph TB
    subgraph "CAMADA DE APRESENTAÇÃO"
        HTML[HTML Report]
        CHAT[Chatbot JS]
        CHARTS[Chart.js Graphs]
    end

    subgraph "CAMADA DE ORQUESTRAÇÃO"
        AGENT[SRAG Agent<br/>Orchestrator]
    end

    subgraph "CAMADA DE FERRAMENTAS"
        DB_TOOL[Database Tool]
        NEWS_TOOL[News Tool]
    end

    subgraph "CAMADA DE CONTEXTO"
        MCP[Healthcare Context<br/>Provider MCP]
    end

    subgraph "CAMADA DE SEGURANÇA"
        GUARD[Medical Guardrails]
        AUDIT[Audit Trail Manager]
        DECISION[Decision Logger]
    end

    subgraph "CAMADA DE DADOS"
        SQLITE[(SQLite DB<br/>srag_cases)]
        AUDIT_DB[(SQLite DB<br/>audit)]
        CSV[CSV DATASUS]
    end

    subgraph "CAMADA EXTERNA"
        NEWS_API[News API]
    end

    %% Fluxo principal
    AGENT --> DB_TOOL
    AGENT --> NEWS_TOOL
    AGENT --> MCP

    %% Tools para dados
    DB_TOOL --> SQLITE
    NEWS_TOOL --> NEWS_API

    %% Segurança
    DB_TOOL --> GUARD
    DB_TOOL --> AUDIT
    MCP --> AUDIT
    AUDIT --> DECISION
    DECISION --> AUDIT_DB

    %% Apresentação
    AGENT --> HTML
    HTML --> CHAT
    HTML --> CHARTS

    %% ETL
    CSV -.ETL.-> SQLITE

    style AGENT fill:#667eea,stroke:#333,stroke-width:3px,color:#fff
    style GUARD fill:#ef4444,stroke:#333,stroke-width:2px,color:#fff
    style AUDIT fill:#f59e0b,stroke:#333,stroke-width:2px,color:#fff
    style MCP fill:#10b981,stroke:#333,stroke-width:2px,color:#fff
```
